import{a as A,S as M,N as G,P as N,K as te,i as oe,A as ne}from"./assets/vendor-DwraIAnb.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}})();const S="https://books-backend.p.goit.global/books";async function ie(){try{const e=await A.get(`${S}/category-list`);return console.log(e.data),e.data}catch(e){return console.error("Помилка при отриманні категорій:",e),[]}}async function D(){try{const e=await A.get(`${S}/top-books`);return console.log(e.data),e.data}catch(e){return console.error("Помилка при отриманні топу книг:",e),[]}}async function se(e){try{const t=await A.get(`${S}/category`,{params:{category:e}});return console.log(t.data),t.data}catch(t){return console.error("Помилка при отриманні книг за категорією:",t),[]}}async function re(e){try{const t=await A.get(`${S}/${e}`);return console.log(t.data),t.data}catch(t){return console.error("Помилка при отриманні інформації про книгу книги:",t),null}}const ae=document.querySelector(".burger-btn"),P=document.querySelector(".mobile-menu"),le=document.querySelector(".close-btn"),ce=document.querySelectorAll(".mobile-nav-link");ae.addEventListener("click",()=>{P.classList.add("is-open"),document.body.style.overflow="hidden"});le.addEventListener("click",()=>{P.classList.remove("is-open"),document.body.style.overflow=""});ce.forEach(e=>{e.addEventListener("click",()=>{P.classList.remove("is-open"),document.body.style.overflow=""})});const de=[{alt:"A book, sweater and a cup",mob:new URL("/GreatLoom/assets/slide-1-mob-Cc6zvtrp.jpg",import.meta.url).href,mob2x:new URL("/GreatLoom/assets/slide-1-mob@2x-C1Cua2dF.jpg",import.meta.url).href,tab:new URL("/GreatLoom/assets/slide-1-tab-B-iawSTV.jpg",import.meta.url).href,tab2x:new URL("/GreatLoom/assets/slide-1-tab@2x-BDrlqYgA.jpg",import.meta.url).href,desk:new URL("/GreatLoom/assets/slide-1-desck-B8PASKW_.jpg",import.meta.url).href,desk2x:new URL("/GreatLoom/assets/slide-1-desck@2x-DQD8wfpB.jpg",import.meta.url).href},{alt:"A book and glasses",mob:new URL("/GreatLoom/assets/slide-2-mob-DDbJJ4lu.jpg",import.meta.url).href,mob2x:new URL("/GreatLoom/assets/slide-2-mob@2x-uw3nuwm-.jpg",import.meta.url).href,tab:new URL("/GreatLoom/assets/slide-2-tab-90L-xNWz.jpg",import.meta.url).href,tab2x:new URL("/GreatLoom/assets/slide-2-tab@2x-BmPtjbdk.jpg",import.meta.url).href,desk:new URL("/GreatLoom/assets/slide-2-desck-C8ZwBFDl.jpg",import.meta.url).href,desk2x:new URL("/GreatLoom/assets/slide-2-desck@2x-ixCL5MHK.jpg",import.meta.url).href},{alt:"Bookshelves with lots of books",mob:new URL("/GreatLoom/assets/slide-3-mob-QYLd9H-Q.jpg",import.meta.url).href,mob2x:new URL("/GreatLoom/assets/slide-3-mob@2x-DvJp_sXF.jpg",import.meta.url).href,tab:new URL("/GreatLoom/assets/slide-3-tab-BSTLpl4t.jpg",import.meta.url).href,tab2x:new URL("/GreatLoom/assets/slide-3-tab@2x-DJOgWmei.jpg",import.meta.url).href,desk:new URL("/GreatLoom/assets/slide-3-desck-DIHVxR5Y.jpg",import.meta.url).href,desk2x:new URL("/GreatLoom/assets/slide-3-desck@2x-DBh22Oh4.jpg",import.meta.url).href},{alt:"A vase with flowers in front of white wall",mob:new URL("/GreatLoom/assets/slide-4-mob-BgWQO8Go.jpg",import.meta.url).href,mob2x:new URL("/GreatLoom/assets/slide-4-mob@2x-UXlyVfUq.jpg",import.meta.url).href,tab:new URL("/GreatLoom/assets/slide-4-tab-UGM7yKlF.jpg",import.meta.url).href,tab2x:new URL("/GreatLoom/assets/slide-4-tab@2x-r3kyjrid.jpg",import.meta.url).href,desk:new URL("/GreatLoom/assets/slide-4-desck-DRlw8fXH.jpg",import.meta.url).href,desk2x:new URL("/GreatLoom/assets/slide-4-desck@2x-D_brjqpn.jpg",import.meta.url).href}],ue=[{subtitle:"Get 10% off your first order"},{subtitle:"Save 15% on some books"},{subtitle:"Summer Sale! Up to -40% discounts"},{subtitle:"Last chance to buy our spring bestsellers"}];function me(e){const t=document.querySelector("#hero-swiper");if(!t){console.error("[Swiper] Container #hero-swiper not found!");return}const o=e.map(n=>`
        <li class="swiper-slide">
          <picture>
            <source srcset="${n.desk} 1x, ${n.desk2x} 2x" media="(min-width: 1440px)" />
            <source srcset="${n.tab} 1x, ${n.tab2x} 2x" media="(min-width: 768px)" />
            <img src="${n.mob}" srcset="${n.mob2x} 2x" alt="${n.alt}" class="hero-slide-img" loading="lazy" />
          </picture>
        </li>
      `).join("");t.innerHTML=o}function C(){const e=document.querySelector(".swiper-btn.prev"),t=document.querySelector(".swiper-btn.next");!k||!e||!t||(e.disabled=k.isBeginning,t.disabled=k.isEnd,e.classList.toggle("disabled",k.isBeginning),t.classList.toggle("disabled",k.isEnd))}function T(e){const t=document.querySelector(".hero-subtitle");if(!t)return;const o=ue[e];o&&(t.textContent=o.subtitle)}let k;window.addEventListener("DOMContentLoaded",()=>{me(de);const e=document.querySelector(".swiper-btn.next"),t=document.querySelector(".swiper-btn.prev");requestAnimationFrame(()=>{k=new M(".swiper-gallery",{modules:[G,N],slidesPerView:1,loop:!1,allowTouchMove:!0,wrapperTag:"ul",navigation:{nextEl:e,prevEl:t},on:{init:()=>{C(),T(0)},slideChange:function(){C(),T(this.activeIndex)}}})})});let L="all",b=window.innerWidth<=768?10:24,pe=4,h=[],p=!1,E=!1;function F(){return window.innerWidth<=768?10:24}const x=document.getElementById("book-list"),y=document.getElementById("show-more-btn"),fe=document.getElementById("showing-count"),ge=document.getElementById("total-count");document.querySelectorAll(".category-btn");function i(e,t=null){console.log(`[Books App Debug] ${e}`,t||"")}async function ye(){try{i("Fetching top books...");const e=await D();i("Raw API response for top books:",e),i("Is array?",Array.isArray(e)),i("Data length:",e?e.length:"null/undefined");let t=[];if(Array.isArray(e)&&e.length>0?(i("Processing array response..."),e[0]&&e[0].books&&Array.isArray(e[0].books)?(i("Found category groups with books arrays"),e.forEach(o=>{o.books&&Array.isArray(o.books)&&(t=t.concat(o.books.map(n=>({_id:n._id,title:n.title,author:n.author,book_image:n.book_image,list_name:o.list_name,description:n.description||"",buy_links:n.buy_links||[]}))))})):e[0]&&(e[0]._id||e[0].id)&&e[0].title?(i("Found direct array of books"),t=e.map(o=>({_id:o._id||o.id,title:o.title,author:o.author,book_image:o.book_image||o.image,list_name:o.list_name||"General",description:o.description||"",buy_links:o.buy_links||[]}))):i("Unknown array structure:",e[0])):e&&typeof e=="object"&&!Array.isArray(e)&&(i("Processing object response..."),e.books&&Array.isArray(e.books)?(i("Found books array in object"),t=e.books.map(o=>({_id:o._id||o.id,title:o.title,author:o.author,book_image:o.book_image||o.image,list_name:o.list_name||"General",description:o.description||"",buy_links:o.buy_links||[]}))):e.title&&(i("Found single book object"),t=[{_id:e._id||e.id,title:e.title,author:e.author,book_image:e.book_image||e.image,list_name:e.list_name||"General",description:e.description||"",buy_links:e.buy_links||[]}])),t.length>0)return i(`Successfully processed ${t.length} books from API`),E=!1,t;throw i("No valid books found in API response, using backup"),new Error("No valid books found in API response")}catch(e){return i("Top books API failed:",e.message),E=!0,[]}}async function he(e){try{i(`Fetching books for category: ${e}`);const t=await se(e);i("Raw API response for category books:",t);let o=[];if(Array.isArray(t)&&t.length>0?o=t.map(n=>({_id:n._id||n.id,title:n.title,author:n.author,book_image:n.book_image||n.image,list_name:e,description:n.description||"",buy_links:n.buy_links||[]})):t&&typeof t=="object"&&t.books&&Array.isArray(t.books)&&(o=t.books.map(n=>({_id:n._id||n.id,title:n.title,author:n.author,book_image:n.book_image||n.image,list_name:e,description:n.description||"",buy_links:n.buy_links||[]}))),o.length>0)return i(`Loaded ${o.length} books for category ${e}`),o;throw new Error("No books found for category")}catch(t){return i(`Category books API failed for ${e}, using filtered backup data:`,t.message),[]}}function be(e){return`
    <li class="book-item">
        <img
            class="book-image"
            src="${e.book_image||"https://via.placeholder.com/227x323?text=No+Image"}"
            alt="${e.title} by ${e.author}"
            loading="lazy"
            onerror="this.src='https://via.placeholder.com/227x323?text=No+Image'"
        />
        <div class="book-content">
            <div class="book-header">
                <div class="book-info">
                    <h3 class="book-title">${e.title}</h3>
                    <p class="book-author">${e.author}</p>
                </div>
                <div class="book-price">Check Price</div>
            </div>
            <button class="learn-more-btn" onclick="handleLearnMore('${e._id}')">
                Learn More
            </button>
        </div>
    </li>
  `}function we(){return`
    <li class="book-item">
      <div class="book-image" style="background: #e0e0e0; animation: pulse 1.5s ease-in-out infinite;"></div>
      <div class="book-content">
        <div class="book-header">
          <div class="book-info">
            <div style="height: 20px; background: #e0e0e0; border-radius: 4px; margin-bottom: 8px; animation: pulse 1.5s ease-in-out infinite;"></div>
            <div style="height: 16px; background: #e0e0e0; border-radius: 4px; width: 70%; animation: pulse 1.5s ease-in-out infinite;"></div>
          </div>
          <div style="height: 24px; background: #e0e0e0; border-radius: 4px; width: 60px; animation: pulse 1.5s ease-in-out infinite;"></div>
        </div>
        <div style="height: 40px; background: #e0e0e0; border-radius: 4px; animation: pulse 1.5s ease-in-out infinite;"></div>
      </div>
    </li>
  `}function O(){return L==="all"?h:h.filter(e=>e.list_name===L)}function z(){p=!0;const e=window.innerWidth<=768?10:24;x.innerHTML=Array(e).fill(we()).join(""),y.disabled=!0,i("Showing loading state")}function _(){if(p){i("Still loading, skipping render");return}const e=O(),t=e.slice(0,b);i(`Rendering ${t.length} books out of ${e.length} total`),t.length===0?x.innerHTML='<li style="grid-column: 1/-1; text-align: center; padding: 40px; color: #0b0500;">No books found for this category.</li>':x.innerHTML=t.map(o=>be(o)).join(""),fe.textContent=t.length,ge.textContent=e.length,t.length>=e.length?y.classList.add("hidden"):y.classList.remove("hidden"),y.disabled=!1}async function ke(){i(`Loading books for category: ${L}`),z();try{if(L==="all"?h=await ye():h=await he(L),h.length===0)throw new Error("No books loaded");p=!1,i(`Successfully loaded ${h.length} books`),_()}catch(e){i("Error loading books:",e.message),p=!1,p=!1,x.innerHTML='<li style="grid-column: 1/-1; text-align: center; padding: 40px; color: #0b0500;">Unable to load books. Please check your internet connection and try again.</li>',y&&y.classList.add("hidden")}}async function Le(e){if(p){i("Already loading, ignoring category selection");return}i(`Category selected: ${e}`),L=e,b=F(),document.querySelectorAll(".category-btn").forEach(t=>{t.classList.remove("active"),t.dataset.category===e&&t.classList.add("active")}),await ke()}function ve(){if(p)return;const e=O();b=Math.min(b+pe,e.length),i(`Show more clicked, now showing ${b} books`),_()}const W=document.createElement("style");W.textContent=`
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }
`;document.head.appendChild(W);document.querySelectorAll(".category-btn").forEach(e=>{e.addEventListener("click",()=>{Le(e.dataset.category)})});y&&y.addEventListener("click",ve);window.addEventListener("resize",()=>{const e=F(),t=window.innerWidth<=768?24:10;b===t&&(b=e,_())});function U(e){const t=document.querySelector(".count");if(t&&E){if(t.style.color="#e15d05",t.style.fontWeight="500",t.title="Using offline data - API server unavailable or blocked by CORS policy",!t.querySelector(".offline-indicator")){const o=document.createElement("span");o.className="offline-indicator",o.innerHTML=" 🔴",o.style.fontSize="12px",o.title="Offline mode",t.appendChild(o)}}else if(t){t.style.color="#0b0500",t.style.fontWeight="normal",t.title="Live data from API";const o=t.querySelector(".offline-indicator");if(o&&o.remove(),!t.querySelector(".online-indicator")){const n=document.createElement("span");n.className="online-indicator",n.innerHTML=" 🟢",n.style.fontSize="12px",n.title="Live data",t.appendChild(n),setTimeout(()=>{n.parentNode&&n.remove()},3e3)}}}document.addEventListener("DOMContentLoaded",async()=>{i("App initializing..."),i("Starting with API-only approach..."),z(),i("Showing loading state, attempting API calls..."),setTimeout(async()=>{try{i("Testing API connectivity...");const e=["https://books-backend.p.goit.global/books/category-list","https://books-backend.p.goit.global/category-list","https://books-backend.p.goit.global/api/books/category-list","https://books-backend.p.goit.global/api/category-list"];let t=null,o=null;for(const n of e){i("Testing fetch to:",n);try{if(t=await fetch(n,{method:"GET",mode:"cors",headers:{Accept:"application/json"}}),t.ok){o=n,i("Found working URL:",o);break}}catch(s){i(`Failed to fetch ${n}:`,s.message)}}if(!o||!t)throw new Error("All API endpoints failed - server unreachable");if(i("Fetch response status:",t.status),t.ok){const n=await t.json();i("Direct fetch successful, data:",n),i("Direct fetch worked, trying API functions...");const s=await ie(),r=await D();if(i("API functions results:",{categories:s,books:r}),Array.isArray(r)&&r.length>0){i("Processing API books data...");let c=[];if(r[0]&&r[0].books?r.forEach(a=>{a.books&&Array.isArray(a.books)&&a.books.forEach(f=>{c.push({_id:f._id,title:f.title,author:f.author,book_image:f.book_image,list_name:a.list_name,description:f.description||"",buy_links:f.buy_links||[]})})}):r[0]&&r[0].title&&(c=r.map(a=>({_id:a._id,title:a.title,author:a.author,book_image:a.book_image,list_name:a.list_name||"General",description:a.description||"",buy_links:a.buy_links||[]}))),c.length>0){i(`Successfully processed ${c.length} books from API!`),h=c,E=!1,p=!1,_(),U(!0);const a=document.createElement("div");a.style.cssText=`
              position: fixed;
              top: 20px;
              right: 20px;
              background: #28a745;
              color: white;
              padding: 12px 16px;
              border-radius: 4px;
              font-size: 14px;
              z-index: 1000;
              box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            `,a.textContent="Successfully loaded live data from API! ✓",document.body.appendChild(a),setTimeout(()=>{a.parentNode&&a.remove()},5e3)}else throw new Error("No books processed from API")}else throw new Error("No books returned from API")}else throw i("Fetch failed with status:",t.status),new Error(`HTTP ${t.status}`)}catch(e){i("API failed completely:",e.message),p=!1,x.innerHTML=`
        <li style="grid-column: 1/-1; text-align: center; padding: 40px; color: #0b0500;">
          <h3>Unable to load books</h3>
          <p>API connection failed: ${e.message}</p>
          <p>Please check your internet connection and try refreshing the page.</p>
        </li>
      `,U();const t=document.createElement("div");t.style.cssText=`
        position: fixed;
        top: 20px;
        right: 20px;
        background: #dc3545;
        color: white;
        padding: 12px 16px;
        border-radius: 4px;
        font-size: 14px;
        z-index: 1000;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      `,t.textContent="API connection failed - no data available",document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.remove()},8e3)}},500),i("App initialization complete")});const xe=new M(".feedbacks .swiper",{modules:[G,N,te],slidesPerView:1,spaceBetween:24,breakpoints:{768:{slidesPerView:2},1440:{slidesPerView:3}},navigation:{nextEl:".feedbacks .swiper-button-next",prevEl:".feedbacks .swiper-button-prev"},pagination:{el:".feedbacks .swiper-pagination"},keyboard:{enabled:!0}});xe.on("keyPress",(e,t)=>{t===9&&e.slideNext()});const g=document.querySelectorAll(".events-item"),H=document.querySelectorAll(".events-indicator"),V=document.getElementById("prevBtn"),Q=document.getElementById("nextBtn");let u=0,m=0;const J=g.length;function w(){window.innerWidth>=768?($(),m===0?(g[0].style.display="block",g[1]&&(g[1].style.display="block")):g[2]&&(g[2].style.display="block"),j(m),q(m,1)):($(),g[u].style.display="block",j(u),q(u,J-1))}function $(){g.forEach(e=>{e.style.display="none"})}function j(e){H.forEach((t,o)=>{o===e?t.classList.add("active"):t.classList.remove("active")})}function q(e,t){V.disabled=e===0,Q.disabled=e===t}function K(){window.innerWidth>=768?m>0&&(m=m-1,w()):u>0&&(u=u-1,w())}function Y(){window.innerWidth>=768?m<1&&(m=m+1,w()):u<J-1&&(u=u+1,w())}function Ee(e){window.innerWidth>=768?m=e:u=e,w()}V.addEventListener("click",K);Q.addEventListener("click",Y);H.forEach((e,t)=>{e.addEventListener("click",function(){Ee(t)})});document.addEventListener("keydown",function(e){e.key==="ArrowLeft"&&K(),e.key==="ArrowRight"&&Y()});window.addEventListener("resize",w);document.querySelectorAll(".events-register").forEach(function(e){e.addEventListener("click",function(){const t=this.closest(".events-item").querySelector(".events-name").textContent;Ae(t)})});function Ae(e){const t=document.getElementById("contactModal"),o=document.getElementById("modalEventName");o.textContent=e,t.classList.add("active"),document.body.style.overflow="hidden"}function B(){document.getElementById("contactModal").classList.remove("active"),document.body.style.overflow="",document.getElementById("modalForm").reset()}document.getElementById("closeModal").addEventListener("click",B);document.getElementById("contactModal").addEventListener("click",function(e){e.target===this&&B()});document.addEventListener("keydown",function(e){e.key==="Escape"&&B()});document.getElementById("modalForm").addEventListener("submit",function(e){e.preventDefault();const t=new FormData(this),o=t.get("name"),n=t.get("email"),s=t.get("message");console.log("Form submitted:",{name:o,email:n,message:s}),alert("Дякуємо за реєстрацію!"),B()});w();const X=document.querySelector(".sub-form"),Se=document.querySelector("#user-email");X.addEventListener("submit",_e);function _e(e){e.preventDefault();const t=Se.value.trim();if(!Be(t)){I("error","Invalid Input","Please provide a valid email address");return}const n=Ie();if(Pe(n,t)){I("warning","Already Subscribed","This email is already on the list"),R();return}Ce(n,t),I("success","Subscribed","You have successfully joined the list"),R()}function Be(e){return/^\w+(\.\w+)?@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/.test(e)}function Ie(){const e=localStorage.getItem("subscriptionList");return e?JSON.parse(e):[]}function Pe(e,t){return e.includes(t)}function Ce(e,t){e.push(t),localStorage.setItem("subscriptionList",JSON.stringify(e))}function I(e,t,o){oe[e]({title:t,message:o,position:"topRight"})}function R(){X.reset()}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".modal-backdrop"),t=document.getElementById("quantity"),o=document.querySelector(".modal-close");let n=1;if(!e||!t||!o){console.warn("Элементы модалки не найдены");return}document.addEventListener("click",l=>{const d=l.target.closest("[data-id]");if(!d)return;const v=d.dataset.id;v&&r(v)}),e.addEventListener("click",l=>{(l.target.classList.contains("modal-backdrop")||l.target.closest(".modal-close"))&&c()}),document.addEventListener("keydown",l=>{l.key==="Escape"&&c()}),document.addEventListener("click",l=>{l.target.classList.contains("decrement")&&f(),l.target.classList.contains("increment")&&a(),l.target.classList.contains("add-to-cart")&&Z(),l.target.classList.contains("buy-now")&&ee(l)});let s=null;async function r(l){const d=await re(l);if(!d){console.warn("Нет данных по книге");return}document.getElementById("modal-title").textContent=d.title,document.getElementById("modal-author").textContent=d.author,document.getElementById("modal-price").textContent=`$${d.price}`,document.getElementById("modal-book-image").src=d.book_image,document.getElementById("modal-book-image").alt=d.title,document.getElementById("details-text").textContent=d.description||"No description",document.getElementById("shipping-text").textContent="We ship across the United States within 2–5 business days. All orders are processed through USPS or a reliable courier service. Enjoy free standard shipping on orders over $50.",document.getElementById("returns-text").textContent="You can return an item within 14 days of receiving your order, provided it hasn’t been used and is in its original condition. To start a return, please contact our support team — we’ll guide you through the process quickly and hassle-free.",t.textContent=1,n=1,e.classList.remove("is-hidden"),document.body.style.overflow="hidden",s&&(s.destroy(),document.querySelectorAll(".ac-panel").forEach(v=>{v.style.height="",v.style.display=""})),s=new ne("#accordion",{duration:300,showMultiple:!0,openOnInit:[0]})}function c(){e.classList.add("is-hidden"),document.body.style.overflow="",s&&(s.destroy(),s=null,document.querySelectorAll(".ac-panel").forEach(l=>{l.style.height="",l.style.display=""}))}function a(){n++,t.textContent=n}function f(){n>1&&(n--,t.textContent=n)}function Z(){console.log(`Додано у корзину: ${n} шт.`)}function ee(l){l.preventDefault(),alert("Дякуємо за покупку")}});
//# sourceMappingURL=index.js.map
