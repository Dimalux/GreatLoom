import{a as w,S as C,N as $,P as T,K as N,A as M}from"./assets/vendor-sNmo7gCo.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}})();const v="https://books-backend.p.goit.global/books";async function q(){try{const e=await w.get(`${v}/category-list`);return console.log(e.data),e.data}catch(e){return console.error("Помилка при отриманні категорій:",e),[]}}async function A(){try{const e=await w.get(`${v}/top-books`);return console.log(e.data),e.data}catch(e){return console.error("Помилка при отриманні топу книг:",e),[]}}async function U(e){try{const t=await w.get(`${v}/category`,{params:{category:e}});return console.log(t.data),t.data}catch(t){return console.error("Помилка при отриманні книг за категорією:",t),[]}}async function F(e){try{const t=await w.get(`${v}/${e}`);return console.log(t.data),t.data}catch(t){return console.error("Помилка при отриманні інформації про книгу книги:",t),null}}document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".menu-button"),t=document.querySelector(".close-button"),o=document.getElementById("mobileMenu"),n=document.querySelectorAll(".custom-checkbox");e.addEventListener("click",function(){o.classList.toggle("open")}),t.addEventListener("click",function(){o.classList.remove("open")}),n.forEach(s=>{s.addEventListener("click",function(r){r.stopPropagation(),this.classList.toggle("checked")})}),document.addEventListener("click",function(s){!o.contains(s.target)&&s.target!==e&&o.classList.remove("open")})});let y="all",m=window.innerWidth<=768?10:24,O=4,p=[],u=!1,k=!1;function L(){return window.innerWidth<=768?10:24}const b=document.getElementById("book-list"),f=document.getElementById("show-more-btn"),j=document.getElementById("showing-count"),z=document.getElementById("total-count");document.querySelectorAll(".category-btn");function i(e,t=null){console.log(`[Books App Debug] ${e}`,t||"")}async function D(){try{i("Fetching top books...");const e=await A();i("Raw API response for top books:",e),i("Is array?",Array.isArray(e)),i("Data length:",e?e.length:"null/undefined");let t=[];if(Array.isArray(e)&&e.length>0?(i("Processing array response..."),e[0]&&e[0].books&&Array.isArray(e[0].books)?(i("Found category groups with books arrays"),e.forEach(o=>{o.books&&Array.isArray(o.books)&&(t=t.concat(o.books.map(n=>({_id:n._id,title:n.title,author:n.author,book_image:n.book_image,list_name:o.list_name,description:n.description||"",buy_links:n.buy_links||[]}))))})):e[0]&&(e[0]._id||e[0].id)&&e[0].title?(i("Found direct array of books"),t=e.map(o=>({_id:o._id||o.id,title:o.title,author:o.author,book_image:o.book_image||o.image,list_name:o.list_name||"General",description:o.description||"",buy_links:o.buy_links||[]}))):i("Unknown array structure:",e[0])):e&&typeof e=="object"&&!Array.isArray(e)&&(i("Processing object response..."),e.books&&Array.isArray(e.books)?(i("Found books array in object"),t=e.books.map(o=>({_id:o._id||o.id,title:o.title,author:o.author,book_image:o.book_image||o.image,list_name:o.list_name||"General",description:o.description||"",buy_links:o.buy_links||[]}))):e.title&&(i("Found single book object"),t=[{_id:e._id||e.id,title:e.title,author:e.author,book_image:e.book_image||e.image,list_name:e.list_name||"General",description:e.description||"",buy_links:e.buy_links||[]}])),t.length>0)return i(`Successfully processed ${t.length} books from API`),k=!1,t;throw i("No valid books found in API response, using backup"),new Error("No valid books found in API response")}catch(e){return i("Top books API failed:",e.message),k=!0,[]}}async function H(e){try{i(`Fetching books for category: ${e}`);const t=await U(e);i("Raw API response for category books:",t);let o=[];if(Array.isArray(t)&&t.length>0?o=t.map(n=>({_id:n._id||n.id,title:n.title,author:n.author,book_image:n.book_image||n.image,list_name:e,description:n.description||"",buy_links:n.buy_links||[]})):t&&typeof t=="object"&&t.books&&Array.isArray(t.books)&&(o=t.books.map(n=>({_id:n._id||n.id,title:n.title,author:n.author,book_image:n.book_image||n.image,list_name:e,description:n.description||"",buy_links:n.buy_links||[]}))),o.length>0)return i(`Loaded ${o.length} books for category ${e}`),o;throw new Error("No books found for category")}catch(t){return i(`Category books API failed for ${e}, using filtered backup data:`,t.message),[]}}function W(e){return`
    <li class="book-item">
        <img
            class="book-image"
            src="${e.book_image||"https://via.placeholder.com/227x323?text=No+Image"}"
            alt="${e.title} by ${e.author}"
            loading="lazy"
            onerror="this.src='https://via.placeholder.com/227x323?text=No+Image'"
        />
        <div class="book-content">
            <div class="book-header">
                <div class="book-info">
                    <h3 class="book-title">${e.title}</h3>
                    <p class="book-author">${e.author}</p>
                </div>
                <div class="book-price">Check Price</div>
            </div>
            <button class="learn-more-btn" onclick="handleLearnMore('${e._id}')">
                Learn More
            </button>
        </div>
    </li>
  `}function R(){return`
    <li class="book-item">
      <div class="book-image" style="background: #e0e0e0; animation: pulse 1.5s ease-in-out infinite;"></div>
      <div class="book-content">
        <div class="book-header">
          <div class="book-info">
            <div style="height: 20px; background: #e0e0e0; border-radius: 4px; margin-bottom: 8px; animation: pulse 1.5s ease-in-out infinite;"></div>
            <div style="height: 16px; background: #e0e0e0; border-radius: 4px; width: 70%; animation: pulse 1.5s ease-in-out infinite;"></div>
          </div>
          <div style="height: 24px; background: #e0e0e0; border-radius: 4px; width: 60px; animation: pulse 1.5s ease-in-out infinite;"></div>
        </div>
        <div style="height: 40px; background: #e0e0e0; border-radius: 4px; animation: pulse 1.5s ease-in-out infinite;"></div>
      </div>
    </li>
  `}function E(){return y==="all"?p:p.filter(e=>e.list_name===y)}function I(){u=!0;const e=window.innerWidth<=768?10:24;b.innerHTML=Array(e).fill(R()).join(""),f.disabled=!0,i("Showing loading state")}function x(){if(u){i("Still loading, skipping render");return}const e=E(),t=e.slice(0,m);i(`Rendering ${t.length} books out of ${e.length} total`),t.length===0?b.innerHTML='<li style="grid-column: 1/-1; text-align: center; padding: 40px; color: #0b0500;">No books found for this category.</li>':b.innerHTML=t.map(o=>W(o)).join(""),j.textContent=t.length,z.textContent=e.length,t.length>=e.length?f.classList.add("hidden"):f.classList.remove("hidden"),f.disabled=!1}async function K(){i(`Loading books for category: ${y}`),I();try{if(y==="all"?p=await D():p=await H(y),p.length===0)throw new Error("No books loaded");u=!1,i(`Successfully loaded ${p.length} books`),x()}catch(e){i("Error loading books:",e.message),u=!1,u=!1,b.innerHTML='<li style="grid-column: 1/-1; text-align: center; padding: 40px; color: #0b0500;">Unable to load books. Please check your internet connection and try again.</li>',f&&f.classList.add("hidden")}}async function Q(e){if(u){i("Already loading, ignoring category selection");return}i(`Category selected: ${e}`),y=e,m=L(),document.querySelectorAll(".category-btn").forEach(t=>{t.classList.remove("active"),t.dataset.category===e&&t.classList.add("active")}),await K()}function V(){if(u)return;const e=E();m=Math.min(m+O,e.length),i(`Show more clicked, now showing ${m} books`),x()}const P=document.createElement("style");P.textContent=`
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }
`;document.head.appendChild(P);document.querySelectorAll(".category-btn").forEach(e=>{e.addEventListener("click",()=>{Q(e.dataset.category)})});f&&f.addEventListener("click",V);window.addEventListener("resize",()=>{const e=L(),t=window.innerWidth<=768?24:10;m===t&&(m=e,x())});function _(e){const t=document.querySelector(".count");if(t&&k){if(t.style.color="#e15d05",t.style.fontWeight="500",t.title="Using offline data - API server unavailable or blocked by CORS policy",!t.querySelector(".offline-indicator")){const o=document.createElement("span");o.className="offline-indicator",o.innerHTML=" 🔴",o.style.fontSize="12px",o.title="Offline mode",t.appendChild(o)}}else if(t){t.style.color="#0b0500",t.style.fontWeight="normal",t.title="Live data from API";const o=t.querySelector(".offline-indicator");if(o&&o.remove(),!t.querySelector(".online-indicator")){const n=document.createElement("span");n.className="online-indicator",n.innerHTML=" 🟢",n.style.fontSize="12px",n.title="Live data",t.appendChild(n),setTimeout(()=>{n.parentNode&&n.remove()},3e3)}}}document.addEventListener("DOMContentLoaded",async()=>{i("App initializing..."),i("Starting with API-only approach..."),I(),i("Showing loading state, attempting API calls..."),setTimeout(async()=>{try{i("Testing API connectivity...");const e=["https://books-backend.p.goit.global/books/category-list","https://books-backend.p.goit.global/category-list","https://books-backend.p.goit.global/api/books/category-list","https://books-backend.p.goit.global/api/category-list"];let t=null,o=null;for(const n of e){i("Testing fetch to:",n);try{if(t=await fetch(n,{method:"GET",mode:"cors",headers:{Accept:"application/json"}}),t.ok){o=n,i("Found working URL:",o);break}}catch(s){i(`Failed to fetch ${n}:`,s.message)}}if(!o||!t)throw new Error("All API endpoints failed - server unreachable");if(i("Fetch response status:",t.status),t.ok){const n=await t.json();i("Direct fetch successful, data:",n),i("Direct fetch worked, trying API functions...");const s=await q(),r=await A();if(i("API functions results:",{categories:s,books:r}),Array.isArray(r)&&r.length>0){i("Processing API books data...");let c=[];if(r[0]&&r[0].books?r.forEach(a=>{a.books&&Array.isArray(a.books)&&a.books.forEach(g=>{c.push({_id:g._id,title:g.title,author:g.author,book_image:g.book_image,list_name:a.list_name,description:g.description||"",buy_links:g.buy_links||[]})})}):r[0]&&r[0].title&&(c=r.map(a=>({_id:a._id,title:a.title,author:a.author,book_image:a.book_image,list_name:a.list_name||"General",description:a.description||"",buy_links:a.buy_links||[]}))),c.length>0){i(`Successfully processed ${c.length} books from API!`),p=c,k=!1,u=!1,x(),_(!0);const a=document.createElement("div");a.style.cssText=`
              position: fixed;
              top: 20px;
              right: 20px;
              background: #28a745;
              color: white;
              padding: 12px 16px;
              border-radius: 4px;
              font-size: 14px;
              z-index: 1000;
              box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            `,a.textContent="Successfully loaded live data from API! ✓",document.body.appendChild(a),setTimeout(()=>{a.parentNode&&a.remove()},5e3)}else throw new Error("No books processed from API")}else throw new Error("No books returned from API")}else throw i("Fetch failed with status:",t.status),new Error(`HTTP ${t.status}`)}catch(e){i("API failed completely:",e.message),u=!1,b.innerHTML=`
        <li style="grid-column: 1/-1; text-align: center; padding: 40px; color: #0b0500;">
          <h3>Unable to load books</h3>
          <p>API connection failed: ${e.message}</p>
          <p>Please check your internet connection and try refreshing the page.</p>
        </li>
      `,_();const t=document.createElement("div");t.style.cssText=`
        position: fixed;
        top: 20px;
        right: 20px;
        background: #dc3545;
        color: white;
        padding: 12px 16px;
        border-radius: 4px;
        font-size: 14px;
        z-index: 1000;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      `,t.textContent="API connection failed - no data available",document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.remove()},8e3)}},500),i("App initialization complete")});const G=new C(".feedbacks .swiper",{modules:[$,T,N],slidesPerView:1,spaceBetween:24,breakpoints:{768:{slidesPerView:2},1440:{slidesPerView:3}},navigation:{nextEl:".feedbacks .swiper-button-next",prevEl:".feedbacks .swiper-button-prev"},pagination:{el:".feedbacks .swiper-pagination"},keyboard:{enabled:!0}});G.on("keyPress",(e,t)=>{t===9&&e.slideNext()});document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".modal-backdrop"),t=document.getElementById("quantity"),o=document.querySelector(".modal-close");let n=1;if(!e||!t||!o){console.warn("Элементы модалки не найдены");return}document.addEventListener("click",l=>{const d=l.target.closest("[data-id]");if(!d)return;const h=d.dataset.id;h&&r(h)}),e.addEventListener("click",l=>{(l.target.classList.contains("modal-backdrop")||l.target.closest(".modal-close"))&&c()}),document.addEventListener("keydown",l=>{l.key==="Escape"&&c()}),document.addEventListener("click",l=>{l.target.classList.contains("decrement")&&g(),l.target.classList.contains("increment")&&a(),l.target.classList.contains("add-to-cart")&&B(),l.target.classList.contains("buy-now")&&S(l)});let s=null;async function r(l){const d=await F(l);if(!d){console.warn("Нет данных по книге");return}document.getElementById("modal-title").textContent=d.title,document.getElementById("modal-author").textContent=d.author,document.getElementById("modal-price").textContent=`$${d.price}`,document.getElementById("modal-book-image").src=d.book_image,document.getElementById("modal-book-image").alt=d.title,document.getElementById("details-text").textContent=d.description||"No description",document.getElementById("shipping-text").textContent="We ship across the United States within 2–5 business days. All orders are processed through USPS or a reliable courier service. Enjoy free standard shipping on orders over $50.",document.getElementById("returns-text").textContent="You can return an item within 14 days of receiving your order, provided it hasn’t been used and is in its original condition. To start a return, please contact our support team — we’ll guide you through the process quickly and hassle-free.",t.textContent=1,n=1,e.classList.remove("is-hidden"),document.body.style.overflow="hidden",s&&(s.destroy(),document.querySelectorAll(".ac-panel").forEach(h=>{h.style.height="",h.style.display=""})),s=new M("#accordion",{duration:300,showMultiple:!0,openOnInit:[0]})}function c(){e.classList.add("is-hidden"),document.body.style.overflow="",s&&(s.destroy(),s=null,document.querySelectorAll(".ac-panel").forEach(l=>{l.style.height="",l.style.display=""}))}function a(){n++,t.textContent=n}function g(){n>1&&(n--,t.textContent=n)}function B(){console.log(`Додано у корзину: ${n} шт.`)}function S(l){l.preventDefault(),alert("Дякуємо за покупку")}});
//# sourceMappingURL=index.js.map
